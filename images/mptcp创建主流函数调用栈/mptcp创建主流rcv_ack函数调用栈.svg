<svg id="SvgjsSvg1006" width="1769.8192749023438" height="594.7226715087891" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs"><defs id="SvgjsDefs1007"><marker id="SvgjsMarker1026" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1027" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1046" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1047" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1058" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1059" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1062" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1063" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1094" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1095" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1098" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1099" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1136" markerWidth="16" markerHeight="12" refX="0" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1137" d="M15,1.5 L2,6 L15,10.5" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1138" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1139" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1155" markerWidth="16" markerHeight="12" refX="0" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1156" d="M15,1.5 L2,6 L15,10.5" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1157" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1158" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1161" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1162" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1165" markerWidth="16" markerHeight="12" refX="0" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1166" d="M15,1.5 L2,6 L15,10.5" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1167" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1168" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker></defs><g id="SvgjsG1008" transform="translate(450.00421142578125,433.68067932128906)"><path id="SvgjsPath1009" d="M 0 0L 197 0L 197 54.0504093170166L 0 54.0504093170166Z" stroke="#323232" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1010"><text id="SvgjsText1011" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="151" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" y="2.0752046585083006" transform="rotate(0)"><tspan id="SvgjsTspan1012" dy="16" x="98.5"><tspan id="SvgjsTspan1013" style="text-decoration:;">tcp_ipv4.c: tcp_v4_rcv(...)</tspan></tspan><tspan id="SvgjsTspan1014" dy="16" x="98.5"><tspan id="SvgjsTspan1015" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1016" dy="16" x="98.5"><tspan id="SvgjsTspan1017" style="text-decoration:;">从ip层收到ACK</tspan></tspan></text></g></g><g id="SvgjsG1018" transform="translate(522.0042114257812,525.7310886383057)"><path id="SvgjsPath1019" d="M 0 22C 0 -7.333333333333333 53 -7.333333333333333 53 22C 53 51.333333333333336 0 51.333333333333336 0 22Z" stroke="#323232" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1020"><text id="SvgjsText1021" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="26" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" y="12.55" transform="rotate(0)"><tspan id="SvgjsTspan1022" dy="16" x="26.5"><tspan id="SvgjsTspan1023" style="text-decoration:;">ACK</tspan></tspan></text></g></g><g id="SvgjsG1024"><path id="SvgjsPath1025" d="M548.5042114257812 525.7310886383057L548.5042114257812 506.73108863830566L548.5042114257812 506.73108863830566L548.5042114257812 487.73108863830566" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1026)"></path></g><g id="SvgjsG1028" transform="translate(773.2143020629883,255.68067932128906)"><path id="SvgjsPath1029" d="M 0 0L 245 0L 245 37.98318290710449L 0 37.98318290710449Z" stroke="#323232" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1030"><text id="SvgjsText1031" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="218" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" y="9.541591453552247" transform="rotate(0)"><tspan id="SvgjsTspan1032" dy="16" x="122.5"><tspan id="SvgjsTspan1033" style="text-decoration:;">tcp_ipv4.c: tcp_v4_syn_recv_sock(...)</tspan></tspan></text></g></g><g id="SvgjsG1034" transform="translate(427.50421142578125,318.63446044921875)"><path id="SvgjsPath1035" d="M 0 0L 242 0L 242 66.32772827148438L 0 66.32772827148438Z" stroke="#323232" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1036"><text id="SvgjsText1037" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="209" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" y="8.213864135742188" transform="rotate(0)"><tspan id="SvgjsTspan1038" dy="16" x="121"><tspan id="SvgjsTspan1039" style="text-decoration:;">tcp_minisocks.c: tcp_check_req(...)</tspan></tspan><tspan id="SvgjsTspan1040" dy="16" x="121"><tspan id="SvgjsTspan1041" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1042" dy="16" x="121"><tspan id="SvgjsTspan1043" style="text-decoration:;">将skb递交给上层</tspan></tspan></text></g></g><g id="SvgjsG1044"><path id="SvgjsPath1045" d="M669.5042114257812 351.79832458496094L773.2143020629883 274.6722707748413" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1046)"></path></g><g id="SvgjsG1048" transform="translate(554.0042114257812,102.58824157714844)"><path id="SvgjsPath1049" d="M 0 24.046218872070312L 24.046218872070312 0L 360 0L 360 48.092437744140625L 0 48.092437744140625L 0 24.046218872070312Z" stroke="#323232" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1050"><text id="SvgjsText1051" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="340" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" y="6.596218872070312" transform="rotate(0)"><tspan id="SvgjsTspan1052" dy="16" x="180"><tspan id="SvgjsTspan1053" style="text-decoration:;">INET_CONNECTION_SOCK_AF_OPS ipv4_specific用以初</tspan></tspan><tspan id="SvgjsTspan1054" dy="16" x="180"><tspan id="SvgjsTspan1055" style="text-decoration:;">始化INET_CONNECTION_SOCK.icsk_af_ops</tspan></tspan></text></g></g><g id="SvgjsG1056"><path id="SvgjsPath1057" d="M734.0042114257812 150.68067932128906L732.4243927001953 302.00840759277344" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1058)"></path></g><g id="SvgjsG1060"><path id="SvgjsPath1061" d="M548.5042114257812 433.68067932128906L548.5042114257812 409.3214340209961L548.5042114257812 409.3214340209961L548.5042114257812 384.9621887207031" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1062)"></path></g><g id="SvgjsG1064" transform="translate(741.0042114257812,318.63446044921875)"><path id="SvgjsPath1065" d="M 0 0L 309.42018127441406 0L 309.42018127441406 52.37394714355469L 0 52.37394714355469Z" stroke="#323232" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1066"><text id="SvgjsText1067" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="279" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" y="1.2369735717773438" transform="rotate(0)"><tspan id="SvgjsTspan1068" dy="16" x="155"><tspan id="SvgjsTspan1069" style="text-decoration:;">tcp_minisocks.c: tcp_create_openreq_child(...)</tspan></tspan><tspan id="SvgjsTspan1070" dy="16" x="155"><tspan id="SvgjsTspan1071" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1072" dy="16" x="155"><tspan id="SvgjsTspan1073" style="text-decoration:;">创建meta_sock</tspan></tspan></text></g></g><g id="SvgjsG1074" transform="translate(25.00421142578125,25.008407592773438)"><path id="SvgjsPath1075" d="M 0 0L 245 0L 261 16L 261 143L 0 143L 0 0Z" stroke="none" fill-opacity="1" fill="#ffffaa"></path><path id="SvgjsPath1076" d="M 245 0L 245 16L 261 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1077" d="M 0 0L 245 0L 261 16L 261 143L 0 143L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1078"><text id="SvgjsText1079" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="234" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" y="23.55" transform="rotate(0)"><tspan id="SvgjsTspan1080" dy="16" x="130.5"><tspan id="SvgjsTspan1081" style="text-decoration:;">服务器在收到三次握手ack包时才创建新</tspan></tspan><tspan id="SvgjsTspan1082" dy="16" x="130.5"><tspan id="SvgjsTspan1083" style="text-decoration:;">socket并从listen socket迁移到新</tspan></tspan><tspan id="SvgjsTspan1084" dy="16" x="130.5"><tspan id="SvgjsTspan1085" style="text-decoration:;">socket，注意：listen socket的backlog</tspan></tspan><tspan id="SvgjsTspan1086" dy="16" x="130.5"><tspan id="SvgjsTspan1087" style="text-decoration:;">队列缓存的是已被tcp接受</tspan></tspan><tspan id="SvgjsTspan1088" dy="16" x="130.5"><tspan id="SvgjsTspan1089" style="text-decoration:;">（即三次握手已经完成），但还没有被应</tspan></tspan><tspan id="SvgjsTspan1090" dy="16" x="130.5"><tspan id="SvgjsTspan1091" style="text-decoration:;">用层所接受的连接。</tspan></tspan></text></g></g><g id="SvgjsG1092"><path id="SvgjsPath1093" d="M895.7143020629883 293.66386222839355L895.7143020629883 306.14916133880615L895.7143020629883 306.14916133880615L895.7143020629883 318.63446044921875" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1094)"></path></g><g id="SvgjsG1096"><path id="SvgjsPath1097" d="M741.0042114257812 344.8214340209961L669.5042114257812 351.79832458496094" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1098)"></path></g><g id="SvgjsG1100" transform="translate(749.2143020629883,406.63446044921875)"><path id="SvgjsPath1101" d="M 0 0L 304.72267150878906 0L 304.72267150878906 66.09243774414062L 0 66.09243774414062Z" stroke="#323232" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1102"><text id="SvgjsText1103" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="278" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" y="0.5962188720703125" transform="rotate(0)"><tspan id="SvgjsTspan1104" dy="16" x="152.5"><tspan id="SvgjsTspan1105" style="text-decoration:;">mptcp_ctrl.c: mptcp_check_req_master(...)</tspan></tspan><tspan id="SvgjsTspan1106" dy="16" x="152.5"><tspan id="SvgjsTspan1107" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1108" dy="16" x="152.5"><tspan id="SvgjsTspan1109" style="text-decoration:;">创建master_sk，从meta_sk迁移到master_sk，</tspan></tspan><tspan id="SvgjsTspan1110" dy="16" x="152.5"><tspan id="SvgjsTspan1111" style="text-decoration:;">并迁移状态到established</tspan></tspan></text></g></g><g id="SvgjsG1112" transform="translate(1091.2143020629883,406.63446044921875)"><path id="SvgjsPath1113" d="M 0 0L 309.42018127441406 0L 309.42018127441406 52.37394714355469L 0 52.37394714355469Z" stroke="#323232" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1114"><text id="SvgjsText1115" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="253" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" y="1.2369735717773438" transform="rotate(0)"><tspan id="SvgjsTspan1116" dy="16" x="155"><tspan id="SvgjsTspan1117" style="text-decoration:;">mptcp_ctrl.c: mptcp_create_master_sk(...)</tspan></tspan><tspan id="SvgjsTspan1118" dy="16" x="155"><tspan id="SvgjsTspan1119" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1120" dy="16" x="155"><tspan id="SvgjsTspan1121" style="text-decoration:;">创建master_sock，关联到meta_sock</tspan></tspan></text></g></g><g id="SvgjsG1122" transform="translate(1459.827724456787,391.05404567718506)"><path id="SvgjsPath1123" d="M 0 0L 284.93277740478516 0L 284.93277740478516 59.94536590576172L 0 59.94536590576172Z" stroke="#323232" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1124"><text id="SvgjsText1125" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="240" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" y="-2.477317047119141" transform="rotate(0)"><tspan id="SvgjsTspan1126" dy="16" x="142.5"><tspan id="SvgjsTspan1127" style="text-decoration:;">mptcp_ ctrl.c: mptcp_alloc_mpcb(...)</tspan></tspan><tspan id="SvgjsTspan1128" dy="16" x="142.5"><tspan id="SvgjsTspan1129" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1130" dy="16" x="142.5"><tspan id="SvgjsTspan1131" style="text-decoration:;">创建master_sock, 得到如下关系。且赋值</tspan></tspan><tspan id="SvgjsTspan1132" dy="16" x="142.5"><tspan id="SvgjsTspan1133" style="text-decoration:;">meta_sock&lt;-mptcp_meta_specific</tspan></tspan></text></g></g><g id="SvgjsG1134"><path id="SvgjsPath1135" d="M1400.6344833374023 432.8214340209961L1459.827724456787 421.0267286300659" stroke="#323232" stroke-width="2" fill="none" marker-start="url(#SvgjsMarker1136)" marker-end="url(#SvgjsMarker1138)"></path></g><g id="SvgjsG1140" transform="translate(1459.827724456787,485.4206323623657)"><path id="SvgjsPath1141" d="M 0 0L 284.93277740478516 0L 284.93277740478516 59.94536590576172L 0 59.94536590576172Z" stroke="#323232" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1142"><text id="SvgjsText1143" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="246" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" y="-2.477317047119141" transform="rotate(0)"><tspan id="SvgjsTspan1144" dy="16" x="142.5"><tspan id="SvgjsTspan1145" style="text-decoration:;">mptcp_ ctrl.c: mptcp_add_sock(...)</tspan></tspan><tspan id="SvgjsTspan1146" dy="16" x="142.5"><tspan id="SvgjsTspan1147" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1148" dy="16" x="142.5"><tspan id="SvgjsTspan1149" style="text-decoration:;">将master_sock关联到meta_sock，且</tspan><tspan id="SvgjsTspan1150" style="text-decoration:;font-size: inherit;">赋值</tspan></tspan><tspan id="SvgjsTspan1151" dy="16" x="142.5"><tspan id="SvgjsTspan1152" style="text-decoration:;font-size: inherit;">master_sock&lt;-mptcp_sub_specific</tspan></tspan></text></g></g><g id="SvgjsG1153"><path id="SvgjsPath1154" d="M1400.6344833374023 432.8214340209961L1459.827724456787 515.3933153152466" stroke="#323232" stroke-width="2" fill="none" marker-start="url(#SvgjsMarker1155)" marker-end="url(#SvgjsMarker1157)"></path></g><g id="SvgjsG1159"><path id="SvgjsPath1160" d="M1053.9369735717773 439.68067932128906L1091.2143020629883 432.8214340209961" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1161)"></path></g><g id="SvgjsG1163"><path id="SvgjsPath1164" d="M669.5042114257812 351.79832458496094L749.2143020629883 439.68067932128906" stroke="#323232" stroke-width="2" fill="none" marker-start="url(#SvgjsMarker1165)" marker-end="url(#SvgjsMarker1167)"></path></g></svg>